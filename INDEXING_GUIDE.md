# Search Engine Indexing Guide

This guide explains how to use the automated sitemap generation and search engine indexing tools for Project Nightfall.

## Prerequisites

Before using the indexing tools, ensure you have:

1. **Google Search Console API Setup:**
   - `google-credentials.json` file in the project root
   - Google Search Console Indexing API enabled for your project
   - Service account with proper permissions

2. **IndexNow API Setup:**
   - `VITE_INDEXNOW_KEY` environment variable in `.env` file
   - Corresponding key file (e.g., `123abc.txt`) in the `public/` directory

## Available Scripts

### Sitemap Generation

```bash
# Generate category sitemap only
npm run generate-sitemaps

# Generate video sitemap only  
npm run generate-video-sitemap

# Build project (includes both sitemaps)
npm run build
```

### Search Engine Indexing

```bash
# Submit single URL to Google Search Console
npm run index:google "https://project-nightfall.pages.dev/category/amateur"

# Submit multiple URLs to IndexNow
npm run index:now "https://project-nightfall.pages.dev" "https://project-nightfall.pages.dev/trending"

# Submit all main pages and categories to both APIs
npm run index:all
```

## Generated Files

### Sitemaps
- `public/category-sitemap.xml` - All 8 category pages
- `public/video-sitemap.xml` - All video pages (generated by existing script)
- `public/sitemap.xml` - Main sitemap (generated by Vite plugin)

### Robots.txt
Updated to include all sitemaps:
```
Sitemap: https://project-nightfall.pages.dev/sitemap.xml
Sitemap: https://project-nightfall.pages.dev/video-sitemap.xml
Sitemap: https://project-nightfall.pages.dev/category-sitemap.xml
```

## Usage Examples

### Quick Start - Index Everything
```bash
# Generate fresh sitemaps and submit all URLs
npm run build
npm run index:all
```

### Individual URL Submission
```bash
# New category page
npm run index:google "https://project-nightfall.pages.dev/category/new-category"
npm run index:now "https://project-nightfall.pages.dev/category/new-category"

# Multiple URLs to IndexNow
npm run index:now "https://project-nightfall.pages.dev/page1" "https://project-nightfall.pages.dev/page2"
```

### Automated Workflow
```bash
# After adding new content
npm run generate-sitemaps  # Update category sitemap
npm run index:all          # Submit to search engines
```

## API Details

### Google Search Console Indexing API
- **Rate Limit:** 200 requests per day
- **Batch Size:** 1 URL per request
- **Response Time:** Immediate confirmation, indexing within hours
- **Authentication:** Service account JSON key

### IndexNow API
- **Rate Limit:** 10,000 URLs per day
- **Batch Size:** Up to 10,000 URLs per request
- **Response Time:** Immediate confirmation, indexing within minutes
- **Authentication:** API key file verification

## Troubleshooting

### Google API Issues
```bash
# Check credentials file exists
ls -la google-credentials.json

# Verify service account permissions in Google Cloud Console
# Ensure Indexing API is enabled
```

### IndexNow Issues
```bash
# Check environment variable
echo $VITE_INDEXNOW_KEY

# Verify key file exists in public directory
ls -la public/*.txt
```

### Common Errors

**"Module not found" errors:**
- Ensure all dependencies are installed: `npm install`
- Check that TypeScript files are properly parsed

**"Authentication failed":**
- Verify Google credentials file format
- Check IndexNow key file is accessible at the specified URL

**"Rate limit exceeded":**
- Google: Wait 24 hours or reduce submission frequency
- IndexNow: Should not occur with normal usage

## Best Practices

1. **Regular Indexing:**
   - Run `npm run index:all` after major content updates
   - Submit new category pages immediately after creation

2. **Sitemap Maintenance:**
   - Sitemaps are automatically generated during build
   - Category sitemap updates when categories.ts changes

3. **Monitoring:**
   - Check Google Search Console for indexing status
   - Monitor server logs for IndexNow confirmations

4. **Performance:**
   - IndexNow is faster for immediate indexing needs
   - Google provides more detailed indexing feedback

## Integration with Deployment

The build process automatically generates fresh sitemaps:

```bash
npm run build  # Includes sitemap generation
npm run deploy # Deploy with fresh sitemaps
npm run index:all # Submit to search engines
```

This ensures search engines always have the latest site structure and content information.